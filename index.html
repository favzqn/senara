<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Senara â€” Platform Visual Novel Edukatif</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Nunito:wght@400;600;700&display=swap" rel="stylesheet">
  <link href="style/story-cards.css" rel="stylesheet">
  <link href="style/home.css" rel="stylesheet">
  <link href="style/performance.css" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <script defer src="https://cloud.umami.is/script.js" data-website-id="d358dae2-966c-46d3-bf10-c43ae1e20415"></script>
</head>
<body class="bg-amber-50">
  <!-- Navigation (will be injected by navbar.js) -->
  <nav id="navbar-placeholder"></nav>

  <!-- Hero Section -->
  <section class="hero-shell min-h-auto flex items-center justify-center px-4 py-12 md:py-16 relative">
    <!-- Animated blobs -->
    <div class="hero-blob hero-blob--one"></div>
    <div class="hero-blob hero-blob--two"></div>

    <div class="max-w-7xl mx-auto w-full relative z-10">
      <div class="grid lg:grid-cols-2 gap-12 items-center">
        <!-- Left: Content -->
        <div class="space-y-6 order-1">
          <!-- Headline & Subheading -->
          <div class="space-y-4">
            <div class="inline-flex items-center gap-2 px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm font-semibold mb-2">
              ğŸŒ± Senara adalah platform nonprofit
            </div>
            <h1 class="text-5xl md:text-6xl lg:text-7xl font-bold text-amber-900 leading-tight">
              Belajar Lewat Cerita Interaktif
            </h1>
            <p class="text-lg md:text-xl text-amber-700 font-light leading-relaxed">
              Platform visual novel edukatif gratis. Baca cerita, buat pilihan, dan temukan pelajaran baru di setiap perjalanan.
            </p>
          </div>

          <!-- CTA Cluster -->
          <div class="flex flex-col sm:flex-row gap-3 pt-2">
            <a href="koleksi.html" class="btn-primary px-8 py-4 rounded-lg font-semibold text-lg text-center transition-all hover:shadow-lg" data-umami-event="Home hero Mulai Cerita">
              ğŸ® Mulai Cerita
            </a>
            <a href="#senara-section" class="px-8 py-4 rounded-lg font-semibold text-lg text-center border-2 border-amber-900 text-amber-900 hover:bg-amber-50 transition-all">
              Pelajari Lebih Lanjut
            </a>
          </div>

          <!-- Social Proof -->
          <div class="flex items-center gap-4 pt-4">
            <div class="flex -space-x-2">
              <div class="w-10 h-10 rounded-full bg-amber-200 border-2 border-white flex items-center justify-center text-sm font-semibold">ğŸ‘©</div>
              <div class="w-10 h-10 rounded-full bg-green-200 border-2 border-white flex items-center justify-center text-sm font-semibold">ğŸ‘¨</div>
              <div class="w-10 h-10 rounded-full bg-purple-200 border-2 border-white flex items-center justify-center text-sm font-semibold">ğŸ§‘</div>
            </div>
            <div>
              <p class="text-sm font-semibold text-amber-900">
                500+ cerita dimainkan
              </p>
              <p class="text-xs text-amber-700">
                oleh pembaca dari seluruh Indonesia
              </p>
            </div>
          </div>
        </div>

        <!-- Right: Full VN Demo Video/GIF -->
        <div class="space-y-4 mt-10 lg:mt-0 order-2">
          <!-- What is VN? Quick Explainer -->
          <div class="bg-amber-50 border border-amber-200 rounded-xl p-4">
            <p class="text-sm text-amber-900"><strong>Apa itu Visual Novel?</strong> Seperti komik interaktifâ€”kamu membaca cerita, membuat pilihan, dan setiap keputusan mengubah jalan ceritanya.</p>
          </div>

          <!-- Video Demo Section -->
          <div class="flex lg:items-center lg:justify-center">
            <div class="vn-demo-showcase">
              <!-- Video Container -->
              <div class="vn-media-wrapper">
              <video 
                class="vn-media" 
                loop 
                playsinline
                controls
                id="demoVideo"
              >
                <source src="assets/demo.mp4" type="video/mp4">
              </video>
              </div>
            </div>
          </div>
        </div>
      </div>


    </div>
  </section>

  <!-- What is SENARA? Section -->
  <section id="senara-section" class="py-20 px-4 bg-white">
    <div class="max-w-4xl mx-auto text-center">
      <div class="inline-flex items-center justify-center w-16 h-16 bg-amber-100 rounded-full mb-6">
        <span class="text-4xl">ğŸ“–</span>
      </div>
      <h2 class="text-4xl md:text-5xl font-bold text-amber-900 mb-6">
        Apa itu Senara?
      </h2>
      <p class="text-lg md:text-xl text-amber-700 leading-relaxed mb-4 max-w-2xl mx-auto">
        Senara adalah platform nonprofit yang mengajakmu menjelajahi berbagai topik lewat cerita interaktif.
      </p>
      <p class="text-lg text-amber-700 leading-relaxed">
        <strong>Bukan sekadar membaca. Bukan hanya menonton.</strong> 
        <br>
        Pengalaman terbaik hadir saat kamu ikut terlibat dalam ceritanya.
      </p>
    </div>
  </section>

  <!-- How It Works Section -->
  <section class="py-20 px-4 bg-gradient-to-b from-amber-50 to-white">
    <div class="max-w-6xl mx-auto">
      <h2 class="text-4xl md:text-5xl font-bold text-amber-900 text-center mb-4">
        Bagaimana Cara Kerjanya?
      </h2>
      <p class="text-lg text-amber-700 text-center mb-16 max-w-2xl mx-auto">
        Tiga langkah mudah untuk mulai belajar lewat cerita.
      </p>

      <!-- Steps Container -->
      <div class="relative mb-12">
        <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
          <!-- Step 1 -->
          <div class="how-it-works-card">
            <div class="how-it-works-icon">
              <span>ğŸ”</span>
            </div>
            <div class="how-it-works-step-badge">
              <span>1</span>
            </div>
            <h3 class="how-it-works-title">
              Pilih Cerita
            </h3>
            <p class="how-it-works-desc">
              Jelajahi koleksi cerita dengan berbagai topik. Temukan yang paling cocok untukmu.
            </p>
          </div>

          <!-- Step 2 -->
          <div class="how-it-works-card">
            <div class="how-it-works-icon">
              <span>ğŸ“–</span>
            </div>
            <div class="how-it-works-step-badge">
              <span>2</span>
            </div>
            <h3 class="how-it-works-title">
              Baca & Tentukan Pilihanmu
            </h3>
            <p class="how-it-works-desc">
              Ikuti alur cerita dan buat keputusan. Setiap pilihan membuka arah yang berbeda.
            </p>
          </div>

          <!-- Step 3 -->
          <div class="how-it-works-card">
            <div class="how-it-works-icon">
              <span>ğŸ“</span>
            </div>
            <div class="how-it-works-step-badge">
              <span>3</span>
            </div>
            <h3 class="how-it-works-title">
              Lanjutkan Perjalananmu
            </h3>
            <p class="how-it-works-desc">
              Selesaikan cerita dan temukan wawasan baru. Lanjutkan ke cerita lain atau eksplorasi topik yang sama.
            </p>
          </div>
        </div>

        <!-- Desktop connecting lines -->
        <div class="how-it-works-connector hidden md:block"></div>
      </div>

    </div>
  </section>

  <!-- Featured Stories Section -->
  <section class="featured-section-v2">
    <div class="featured-section-inner">
      <!-- Header -->
      <div class="featured-header">
        <div class="featured-header-text">
          <span class="featured-label">Cerita Pilihan</span>
          <h2 class="featured-title">Mulai Petualangan Belajarmu</h2>
          <p class="featured-subtitle">Cerita interaktif yang dipilih komunitas. Setiap pilihan membentuk jalanmu sendiri.</p>
        </div>
        <a href="koleksi.html" class="featured-see-all" data-umami-event="Featured see all">
          Lihat Semua
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
            <path d="M5 12h14M12 5l7 7-7 7"/>
          </svg>
        </a>
      </div>

      <!-- Featured Stories Grid -->
      <div class="featured-grid" id="featuredContainer">
        <!-- Featured stories will be loaded here -->
      </div>
    </div>
  </section>

  <!-- Learning Categories Section -->
  <section class="py-20 px-4 bg-white">
    <div class="max-w-6xl mx-auto">
      <h2 class="text-4xl md:text-5xl font-bold text-amber-900 text-center mb-4">
        Topik yang Bisa Kamu Pelajari
      </h2>
      <p class="text-lg text-amber-700 text-center mb-12 max-w-3xl mx-auto">
        Pilih kategori yang sesuai dengan minatmu.
      </p>
      
      <div class="category-carousel" id="categoryCarousel">
        <!-- Categories will be loaded dynamically from categories.js -->
      </div>
    </div>
  </section>

  <!-- Why Visual Novels Section -->
  <section id="tentang" class="why-vn-section py-24 px-4">
    <div class="max-w-5xl mx-auto relative z-10">
      <h2 class="text-4xl md:text-5xl font-bold text-amber-900 text-center mb-4">
        Kenapa Format Visual Novel?
      </h2>
      <p class="text-lg text-amber-700 text-center mb-12 max-w-2xl mx-auto">
        Format cerita interaktif yang membuat belajar lebih menyenangkan dan mudah diingat.
      </p>

      <!-- Comparison Toggle -->
      <div class="comparison-toggle">
        <button class="active" data-mode="vn" data-umami-event="Why VN toggle visual novel">Visual Novel</button>
        <button data-mode="pdf" data-umami-event="Why VN toggle PDF">Modul PDF</button>
        <button data-mode="socmed" data-umami-event="Why VN toggle socmed">Konten Sosmed</button>
        <button data-mode="youtube" data-umami-event="Why VN toggle youtube">Video YouTube</button>
      </div>

      <!-- Benefit Cards -->
      <div class="grid grid-cols-1 md:grid-cols-3 gap-8 mb-12">
        <div class="benefit-card" data-benefit="1">
          <div class="benefit-icon" data-icon-vn="ğŸ“–" data-icon-pdf="ğŸ“„" data-icon-socmed="ğŸ“±" data-icon-youtube="â–¶ï¸">ğŸ“–</div>
          <div class="benefit-stat" data-stat-vn="70% lebih tinggi" data-stat-pdf="Standar industri" data-stat-socmed="15 detik perhatian" data-stat-youtube="Pasif, tapi visual">70% lebih tinggi</div>
          <h3 data-title-vn="Narasi yang Engaging" data-title-pdf="Konten Terstruktur" data-title-socmed="Konten Bite-sized" data-title-youtube="Penjelasan Visual">Narasi yang Engaging</h3>
          <p data-desc-vn="Cerita yang relatable membuat pembelajaran bermakna dan mudah diingat." data-desc-pdf="Format standar dengan struktur jelas, mudah diakses dan dibagikan." data-desc-socmed="Tips singkat yang mudah dicerna tapi cepat hilang dari feed." data-desc-youtube="Video menjelaskan konsep dengan visual, tapi jarang interaktif.">Cerita yang relatable membuat pembelajaran bermakna dan mudah diingat.</p>
          <div class="benefit-comparison" data-mode="vn">
            <strong>Visual Novel:</strong> Karakter berkembang, dialog natural, emosi tersampaikan lewat visual & suara.
          </div>
          <div class="benefit-comparison" data-mode="pdf">
            <strong>Modul PDF:</strong> Teks terstruktur, mudah dipindai, format standar industri.
          </div>
          <div class="benefit-comparison" data-mode="socmed">
            <strong>Konten Sosmed:</strong> Viral & engaging, tapi konteks terbatas, sulit untuk topik kompleks.
          </div>
          <div class="benefit-comparison" data-mode="youtube">
            <strong>Video YouTube:</strong> Audiovisual menarik, tapi pembelajaran pasif, sulit diulang untuk skenario berbeda.
          </div>
        </div>
        
        <div class="benefit-card" data-benefit="2">
          <div class="benefit-icon" data-icon-vn="ğŸ®" data-icon-pdf="ğŸ“‹" data-icon-socmed="ğŸ‘" data-icon-youtube="â¸ï¸">ğŸ®</div>
          <div class="benefit-stat" data-stat-vn="3x engagement" data-stat-pdf="Engagement rendah" data-stat-socmed="Likes & comments" data-stat-youtube="Bisa di-pause">3x engagement</div>
          <h3 data-title-vn="Interaktif & Menyenangkan" data-title-pdf="Format Pasif" data-title-socmed="Engagement Sosial" data-title-youtube="Kontrol Penonton">Interaktif & Menyenangkan</h3>
          <p data-desc-vn="Pilihan bermakna membuat setiap playthrough unik dan personal." data-desc-pdf="Konten linear yang konsisten, cocok untuk pembelajaran terstruktur." data-desc-socmed="Interaksi terbatas pada likes, shares, dan comments." data-desc-youtube="Penonton bisa pause & rewind, tapi tidak bisa mempengaruhi alur cerita.">Pilihan bermakna membuat setiap playthrough unik dan personal.</p>
          <div class="benefit-comparison" data-mode="vn">
            <strong>Visual Novel:</strong> Pilihan mempengaruhi jalan cerita, quiz terintegrasi, feedback real-time.
          </div>
          <div class="benefit-comparison" data-mode="pdf">
            <strong>Modul PDF:</strong> Konten linear, interaksi minimal, feedback tertunda.
          </div>
          <div class="benefit-comparison" data-mode="socmed">
            <strong>Konten Sosmed:</strong> Interaksi hanya sebatas like, share, commentâ€”tidak mengubah konten.
          </div>
          <div class="benefit-comparison" data-mode="youtube">
            <strong>Video YouTube:</strong> Penonton pasif, bisa pause/rewind tapi tidak ada pilihan atau branching.
          </div>
        </div>
        
        <div class="benefit-card" data-benefit="3">
          <div class="benefit-icon" data-icon-vn="â¤ï¸" data-icon-pdf="ğŸ’¼" data-icon-socmed="â°" data-icon-youtube="ğŸ˜®">â¤ï¸</div>
          <div class="benefit-stat" data-stat-vn="85% retensi" data-stat-pdf="45% retensi" data-stat-socmed="Viral tapi lupa" data-stat-youtube="60% retensi">85% retensi</div>
          <h3 data-title-vn="Koneksi Emosional" data-title-pdf="Pembelajaran Formal" data-title-socmed="Viral & Trending" data-title-youtube="Hiburan Edukatif">Koneksi Emosional</h3>
          <p data-desc-vn="Pembelajaran yang menyentuh hati lebih efektif dan lasting." data-desc-pdf="Pendekatan berbasis konten, ideal untuk pelatihan profesional dan akademik." data-desc-socmed="Konten viral membuat buzz, tapi retensi jangka panjang rendah." data-desc-youtube="Kombinasi audio-visual menciptakan engagement, tapi sering hanya hiburan tanpa pembelajaran mendalam.">Pembelajaran yang menyentuh hati lebih efektif dan lasting.</p>
          <div class="benefit-comparison" data-mode="vn">
            <strong>Visual Novel:</strong> Karakter relatable, cerita personal, resonansi emosional mendalam.
          </div>
          <div class="benefit-comparison" data-mode="pdf">
            <strong>Modul PDF:</strong> Pendekatan formal, fokus pada konten, retensi lebih rendah.
          </div>
          <div class="benefit-comparison" data-mode="socmed">
            <strong>Konten Sosmed:</strong> Mudah viral & shareable, tapi konteks hilang, retensi jangka panjang rendah.
          </div>
          <div class="benefit-comparison" data-mode="youtube">
            <strong>Video YouTube:</strong> Kombinasi visual & audio engaging, tapi sering entertainment-focused, pembelajaran kurang mendalam.
          </div>
        </div>
      </div>

      <!-- Guided Flow -->
      <div class="guided-flow">
        <h3 class="text-xl font-bold text-amber-900 text-center mb-6">Keunggulan Senara</h3>
        <div class="flow-steps">
          <div class="flow-step">
            <div class="flow-step-num">ğŸ¯</div>
            <p class="font-semibold text-amber-900">Cerita Relevan</p>
            <span class="text-sm text-amber-700">Topik yang dekat dengan kehidupan sehari-hari</span>
          </div>
          <div class="flow-step">
            <div class="flow-step-num">ğŸ†“</div>
            <p class="font-semibold text-amber-900">Gratis Selamanya</p>
            <span class="text-sm text-amber-700">Akses semua cerita tanpa biaya apapun</span>
          </div>
          <div class="flow-step">
            <div class="flow-step-num">âœ¨</div>
            <p class="font-semibold text-amber-900">Belajar Fleksibel</p>
            <span class="text-sm text-amber-700">Mainkan kapan saja, di mana saja</span>
          </div>
        </div>
      </div>

      <!-- Testimonial Slider -->
      <div class="testimonial-slider">
        <div class="testimonial-content" id="testimonialContent">
          <div class="testimonial-avatar">ğŸ‘©â€ğŸ«</div>
          <p class="testimonial-quote">"Anak-anak saya jadi berani berdiskusi setelah belajar lewat VN. Mereka merasa cerita itu tentang mereka."</p>
          <p class="testimonial-author">Ibu Sari</p>
          <p class="testimonial-role">Guru SD Negeri 5, Bandung</p>
        </div>
        <div class="testimonial-nav" id="testimonialNav">
          <div class="testimonial-dot active" data-index="0"></div>
          <div class="testimonial-dot" data-index="1"></div>
          <div class="testimonial-dot" data-index="2"></div>
        </div>
      </div>

      <!-- CTA Bar -->
      <div class="cta-bar">
        <a href="koleksi.html" class="cta-primary" data-umami-event="Why VN CTA play free">Jelajahi Cerita</a>
      </div>
    </div>
  </section>

  <!-- Support & Sponsorship Section (Brief) -->
  <section class="py-24 px-4 bg-gradient-to-r from-amber-50 to-orange-50">
    <div class="max-w-6xl mx-auto">
      <div class="text-center mb-12">
        <h2 class="text-4xl md:text-5xl font-bold text-amber-900 mb-4">
          â¤ï¸ Dukung Senara
        </h2>
        <p class="text-lg text-amber-700 mb-8 max-w-2xl mx-auto">
          Senara adalah platform nonprofit. Dukunganmu membantu kami terus membuat cerita edukatif yang bisa diakses semua orang.
        </p>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
        <!-- Trakteer -->
        <div class="bg-white rounded-2xl p-8 border border-orange-100 shadow-sm text-center">
          <div class="text-5xl mb-4">ğŸ°</div>
          <h3 class="text-xl font-bold text-amber-900 mb-3">Donasi via Trakteer</h3>
          <p class="text-amber-800 text-sm mb-6">Dukung pengembangan cerita dan platform Senara.</p>
          <a href="https://trakteer.id/senara.id" target="_blank" rel="noopener noreferrer" class="inline-block bg-orange-500 text-white px-6 py-2 rounded-lg font-semibold hover:bg-orange-600 transition" data-umami-event="Home Trakteer CTA">
            Donasi Sekarang
          </a>
        </div>

        <!-- Partnership -->
        <div class="bg-white rounded-2xl p-8 border border-orange-100 shadow-sm text-center opacity-60">
          <div class="text-5xl mb-4">ğŸ¤</div>
          <h3 class="text-xl font-bold text-amber-900 mb-3">Untuk Guru & Organisasi</h3>
          <p class="text-amber-800 text-sm mb-6">Gunakan Senara untuk pembelajaran di sekolah, komunitas, atau workshop.</p>
          <span class="inline-block bg-gray-300 text-gray-600 px-6 py-2 rounded-lg font-semibold cursor-not-allowed">
            ğŸ”œ Segera Hadir
          </span>
        </div>

        <!-- Contribute -->
        <div class="bg-white rounded-2xl p-8 border border-orange-100 shadow-sm text-center opacity-60">
          <div class="text-5xl mb-4">âœ¨</div>
          <h3 class="text-xl font-bold text-amber-900 mb-3">Ingin Berkontribusi?</h3>
          <p class="text-amber-800 text-sm mb-6">Bergabung dengan tim kreatif kami sebagai artist, writer, atau developer.</p>
          <span class="inline-block bg-gray-300 text-gray-600 px-6 py-2 rounded-lg font-semibold cursor-not-allowed">
            ğŸ”œ Segera Hadir
          </span>
        </div>
      </div>
    </div>
  </section>

  <!-- Footer (will be injected by footer.js) -->
  <footer id="footer-placeholder"></footer>

  <script src="js/config.js"></script>
  <script src="js/constants.js"></script>
  <script src="js/shared-utils.js"></script>
  <script src="js/performance-utils.js"></script>
  <script src="js/navbar.js"></script>
  <script src="js/footer.js"></script>
  <script src="data/stories.js"></script>
  <script src="data/categories.js"></script>
  <!-- <script src="https://cdn.counter.dev/script.js" data-id="af8cab5a-f3b9-4717-8058-68e00f4f917c" data-utcoffset="7"></script> -->
  <script>

    // Load and render categories on page load
    function renderCategories() {
      const container = document.getElementById('categoryCarousel');
      container.innerHTML = '';
      
      allCategoriesData.forEach((category, index) => {
        const link = document.createElement('a');
        link.href = `koleksi.html?category=${category.id}`;
        link.className = 'category-chip hover:no-underline';
        link.dataset.umamiEvent = `Home category ${category.title}`;
        
        link.innerHTML = `
          <div class="chip-icon" style="background: ${category.color}">${category.icon}</div>
          <span class="chip-label">${category.title}</span>
        `;
        
        container.appendChild(link);
      });
    }

    // Featured stories data with metadata
    let featuredStoriesData = [];

    // Create featured story card - new modern design
    function createFeaturedCard(story, index = 0) {
      const emoji = getStoryEmoji(story.id);
      const isComingSoon = story.status === 'coming-soon';
      const isFirst = index === 0;
      
      const card = document.createElement('a');
      card.href = isComingSoon ? '#' : `story.html?id=${story.id}`;
      card.className = `featured-card-v2 ${isFirst ? 'featured-card-hero' : ''}`;
      card.dataset.storyId = story.id;
      if (!isComingSoon) {
        card.dataset.umamiEvent = `Featured play ${story.id}`;
      }
      
      card.innerHTML = `
        <div class="featured-card-visual">
          <span class="featured-card-emoji">${emoji}</span>
          ${isFirst ? '<span class="featured-card-badge">â­ Editor\'s Pick</span>' : ''}
          ${isComingSoon ? '<span class="featured-card-badge featured-card-badge-soon">Segera</span>' : ''}
        </div>
        <div class="featured-card-body">
          <div class="featured-card-tags">
            <span class="featured-tag">${story.difficulty || 'Beginner'}</span>
            <span class="featured-tag-dot">â€¢</span>
            <span class="featured-tag">${story.duration || '30'} menit</span>
          </div>
          <h3 class="featured-card-name">${story.title}</h3>
          ${story.description ? `<p class="featured-card-desc">${story.description}</p>` : ''}
          <div class="featured-card-footer">
            <span class="featured-card-cta">
              ${isComingSoon ? 'Segera Hadir' : 'Mainkan Sekarang â†’'}
            </span>
          </div>
        </div>
      `;
      
      if (isComingSoon) {
        card.style.pointerEvents = 'none';
        card.style.opacity = '0.7';
      }
      
      return card;
    }

    // Load featured stories with filtering
    function loadFeaturedStories() {
      const featured = allStoriesData.filter(story => story.featured);
      featuredStoriesData = featured;
      
      // Sort by creation date (newest first) and mark first as spotlight
      const sorted = featured.sort((a, b) => new Date(b.createdAt || 0) - new Date(a.createdAt || 0));
      
      renderFeaturedCards(sorted);
    }

    // Render featured cards
    function renderFeaturedCards(stories) {
      const container = document.getElementById('featuredContainer');
      container.innerHTML = '';
      
      // Limit to 4 stories for clean grid
      const displayStories = stories.slice(0, 4);
      
      displayStories.forEach((story, index) => {
        const card = createFeaturedCard(story, index);
        container.appendChild(card);
      });
    }

    // Setup filter pills
    function setupFeaturedFilters() {
      const filterPills = document.querySelectorAll('.filter-pill');
      
      filterPills.forEach(pill => {
        pill.addEventListener('click', () => {
          // Update active state
          filterPills.forEach(p => p.classList.remove('active'));
          pill.classList.add('active');
          
          const filterValue = pill.dataset.filter;
          let filtered = featuredStoriesData;
          
          if (filterValue === 'newest') {
            filtered = [...featuredStoriesData].sort((a, b) => new Date(b.createdAt || 0) - new Date(a.createdAt || 0));
          } else if (filterValue === 'popular') {
            filtered = [...featuredStoriesData].sort((a, b) => (b.plays || 0) - (a.plays || 0));
          } else if (filterValue === 'kids') {
            filtered = featuredStoriesData.filter(s => s.age && s.age.includes('5-8'));
          } else if (filterValue === 'teen') {
            filtered = featuredStoriesData.filter(s => s.age && s.age.includes('13+'));
          }
          
          renderFeaturedCards(filtered);
        });
      });
    }


    function setupContributionAccordion() {
      const items = document.querySelectorAll('.contrib-item');
      items.forEach(item => {
        const trigger = item.querySelector('.contrib-trigger');
        const panel = item.querySelector('.contrib-panel');

        trigger.addEventListener('click', () => {
          const isActive = item.classList.contains('active');
          items.forEach(i => {
            i.classList.remove('active');
            const p = i.querySelector('.contrib-panel');
            if (p) p.style.maxHeight = null;
          });

          if (!isActive) {
            item.classList.add('active');
            if (panel) panel.style.maxHeight = panel.scrollHeight + 'px';
          }
        });
      });

      // Expand first item by default
      if (items.length) {
        items[0].classList.add('active');
        const firstPanel = items[0].querySelector('.contrib-panel');
        if (firstPanel) firstPanel.style.maxHeight = firstPanel.scrollHeight + 'px';
      }
    }

    // Load featured stories on page load
    document.addEventListener('DOMContentLoaded', () => {
      initNavbar('home');
      initFooter();
      loadFeaturedStories();
      setupFeaturedFilters();
      setupHeroDemo();
      setupCategoryToggle();
      setupComparisonToggle();
      setupTestimonialSlider();
      setupContributionAccordion();
    });

    function setupCategoryToggle() {
      const grid = document.getElementById('learningCategoryGrid');
      const toggleBtn = document.getElementById('categoryToggleBtn');

      if (!grid || !toggleBtn) return;

      toggleBtn.addEventListener('click', () => {
        const isCollapsed = grid.classList.toggle('collapsed');
        toggleBtn.dataset.state = isCollapsed ? 'collapsed' : 'expanded';
        toggleBtn.textContent = isCollapsed ? 'Tampilkan lebih banyak' : 'Tampilkan lebih sedikit';
      });
    }

    // Comparison toggle for Why VN section
    function setupComparisonToggle() {
      const toggleBtns = document.querySelectorAll('.comparison-toggle button');
      const comparisons = document.querySelectorAll('.benefit-comparison');
      const benefitCards = document.querySelectorAll('.benefit-card');

      // Helper to convert mode to data attribute suffix (vn -> Vn, pdf -> Pdf, socmed -> Socmed, youtube -> Youtube)
      const getModeKey = (mode) => {
        const map = {
          'vn': 'Vn',
          'pdf': 'Pdf',
          'socmed': 'Socmed',
          'youtube': 'Youtube'
        };
        return map[mode] || 'Vn';
      };

      toggleBtns.forEach(btn => {
        btn.addEventListener('click', () => {
          const mode = btn.dataset.mode;
          const modeKey = getModeKey(mode);
          
          // Update active button
          toggleBtns.forEach(b => b.classList.remove('active'));
          btn.classList.add('active');
          
          // Update comparison text visibility
          comparisons.forEach(comp => {
            if (comp.dataset.mode === mode) {
              comp.classList.add('show');
            } else {
              comp.classList.remove('show');
            }
          });

          // Update icons, stats, titles, and descriptions
          benefitCards.forEach(card => {
            const iconElement = card.querySelector('.benefit-icon');
            const statElement = card.querySelector('.benefit-stat');
            const titleElement = card.querySelector('h3');
            const descElement = card.querySelector('p[data-desc-vn]');

            if (iconElement) {
              const newIcon = iconElement.dataset[`icon${modeKey}`];
              if (newIcon) iconElement.textContent = newIcon;
            }

            if (statElement) {
              const newStat = statElement.dataset[`stat${modeKey}`];
              if (newStat) statElement.textContent = newStat;
            }

            if (titleElement) {
              const newTitle = titleElement.dataset[`title${modeKey}`];
              if (newTitle) titleElement.textContent = newTitle;
            }

            if (descElement) {
              const newDesc = descElement.dataset[`desc${modeKey}`];
              if (newDesc) descElement.textContent = newDesc;
            }
          });
        });
      });

      // Show VN comparisons by default
      comparisons.forEach(comp => {
        if (comp.dataset.mode === 'vn') {
          comp.classList.add('show');
        }
      });
    }

    // Testimonial carousel with improved details
    const testimonials = [
      {
        quote: '"Anak-anak saya jadi berani berdiskusi setelah belajar lewat VN. Mereka merasa cerita itu tentang mereka."',
        author: 'Ibu Sari',
        role: 'Guru SD Negeri 5, Bandung',
        avatar: 'ğŸ‘©â€ğŸ«'
      },
      {
        quote: '"Saya lebih fokus belajar coding karena VN membuat konsep jadi mudah dipahami. Rasanya kayak main game!"',
        author: 'Rafi A.',
        role: 'Siswa SMP, Jakarta',
        avatar: 'ğŸ‘¦'
      },
      {
        quote: '"Sebagai fasilitator, VN membuat sesi lebih interaktif. Peserta jadi lebih engaged dan diskusi lebih hidup."',
        author: 'Kak Dina',
        role: 'Mentor, Komunitas Belajar Bareng',
        avatar: 'ğŸ‘©â€ğŸ’¼'
      }
    ];

    let currentTestimonialIndex = 0;

    function setupTestimonialSlider() {
      const dots = document.querySelectorAll('.testimonial-dot');
      const content = document.getElementById('testimonialContent');

      if (!dots.length || !content) return;

      dots.forEach(dot => {
        dot.addEventListener('click', () => {
          const index = parseInt(dot.dataset.index);
          currentTestimonialIndex = index;
          updateTestimonial();
        });
      });

      // Auto-rotate every 5 seconds
      setInterval(() => {
        currentTestimonialIndex = (currentTestimonialIndex + 1) % testimonials.length;
        updateTestimonial();
      }, 5000);
    }

    function updateTestimonial() {
      const content = document.getElementById('testimonialContent');
      const dots = document.querySelectorAll('.testimonial-dot');
      const testimonial = testimonials[currentTestimonialIndex];

      if (content) {
        content.innerHTML = `
          <div class="testimonial-avatar">${testimonial.avatar}</div>
          <p class="testimonial-quote">${testimonial.quote}</p>
          <p class="testimonial-author">${testimonial.author}</p>
          <p class="testimonial-role">${testimonial.role}</p>
        `;
      }

      dots.forEach((dot, index) => {
        dot.classList.toggle('active', index === currentTestimonialIndex);
      });
    }

    // Comparison toggle for Why VN section
    function setupComparisonToggle() {
      const toggleBtns = document.querySelectorAll('.comparison-toggle button');
      const comparisons = document.querySelectorAll('.benefit-comparison');
      const benefitCards = document.querySelectorAll('.benefit-card');

      // Helper to convert mode to data attribute suffix (vn -> Vn, pdf -> Pdf, socmed -> Socmed, youtube -> Youtube)
      const getModeKey = (mode) => {
        const map = {
          'vn': 'Vn',
          'pdf': 'Pdf',
          'socmed': 'Socmed',
          'youtube': 'Youtube'
        };
        return map[mode] || 'Vn';
      };

      toggleBtns.forEach(btn => {
        btn.addEventListener('click', () => {
          const mode = btn.dataset.mode;
          const modeKey = getModeKey(mode);
          
          // Update active button
          toggleBtns.forEach(b => b.classList.remove('active'));
          btn.classList.add('active');
          
          // Update comparison text visibility
          comparisons.forEach(comp => {
            if (comp.dataset.mode === mode) {
              comp.classList.add('show');
            } else {
              comp.classList.remove('show');
            }
          });

          // Update icons, stats, titles, and descriptions
          benefitCards.forEach(card => {
            const iconElement = card.querySelector('.benefit-icon');
            const statElement = card.querySelector('.benefit-stat');
            const titleElement = card.querySelector('h3');
            const descElement = card.querySelector('p[data-desc-vn]');

            if (iconElement) {
              const newIcon = iconElement.dataset[`icon${modeKey}`];
              if (newIcon) iconElement.textContent = newIcon;
            }

            if (statElement) {
              const newStat = statElement.dataset[`stat${modeKey}`];
              if (newStat) statElement.textContent = newStat;
            }

            if (titleElement) {
              const newTitle = titleElement.dataset[`title${modeKey}`];
              if (newTitle) titleElement.textContent = newTitle;
            }

            if (descElement) {
              const newDesc = descElement.dataset[`desc${modeKey}`];
              if (newDesc) descElement.textContent = newDesc;
            }
          });
        });
      });

      // Show VN comparisons by default
      comparisons.forEach(comp => {
        if (comp.dataset.mode === 'vn') {
          comp.classList.add('show');
        }
      });
    }


    // Load featured stories on page load
    document.addEventListener('DOMContentLoaded', () => {
      initNavbar('home');
      initFooter();
      renderCategories();
      loadFeaturedStories();
      setupFeaturedFilters();
      setupCategoryToggle();
      setupComparisonToggle();
      setupTestimonialSlider();
      setupContributionAccordion();
    });
  </script>
</body>
</html>
